// EXAMPLE MIGRATION - Rename to .ts to activate
// import { makeMigration } from "@convex-dev/migrations";
//
// export default makeMigration({
//   async up(ctx) {
//     // Example: Add notification preferences for all existing users
//     const users = await ctx.db.query("users").collect();
//
//     for (const user of users) {
//       // Idempotency check
//       const existing = await ctx.db
//         .query("notificationPreferences")
//         .withIndex("by_user", (q) => q.eq("userId", user._id))
//         .unique();
//
//       if (!existing) {
//         await ctx.db.insert("notificationPreferences", {
//           userId: user._id,
//           email: true,
//           push: true,
//           inApp: true,
//           createdAt: Date.now(),
//           updatedAt: Date.now(),
//         });
//         console.log(`Created preferences for user ${user._id}`);
//       }
//     }
//
//     console.log(`Migration complete: ${users.length} users processed`);
//   },
//
//   // Optional: Rollback migration
//   // async down(ctx) {
//   //   const prefs = await ctx.db.query("notificationPreferences").collect();
//   //   for (const pref of prefs) {
//   //     await ctx.db.delete(pref._id);
//   //   }
//   //   console.log(`Rollback complete: ${prefs.length} preferences deleted`);
//   // },
// });
